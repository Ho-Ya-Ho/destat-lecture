{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-34bf4a6cc0521b2fd92414d12c8ab3a670f2aac3",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/SurveyFactory.sol": "project/contracts/SurveyFactory.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": [],
      "viaIR": true
    },
    "sources": {
      "project/contracts/Survey.sol": {
        "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.28;\n\nstruct Question {\n    string question;\n    string[] options;\n}\n\nstruct Answer {\n    address respondent;\n    uint8[] answers;\n}\n\ncontract Survey {\n    // contract의 field는 storage에 저장됨\n    // Key-Value Storage\n    string public title;\n    string public description;\n    uint256 public targetNumber;\n    uint256 public rewardAmount;\n    Question[] questions;\n    Answer[] answers;\n    mapping(address => uint) testMap;\n\n    // primitive: int, bool, uint -> primitive은 memory, storage 키워드를 사용하지 않아도됨\n    // primitive 타입 + string 일 경우 하나의 slot을 나눠서 사용한다 (32bytes보다 작다면)\n    // memory, storage, calldata\n    constructor(\n        string memory _title,\n        string memory _description,\n        uint256 _targetNumber,\n        Question[] memory _questions\n    ) payable {\n        title = _title;\n        description = _description;\n        targetNumber = _targetNumber;\n        rewardAmount = msg.value / targetNumber;\n        testMap[msg.sender] = 1000;\n        for (uint i = 0; i < _questions.length; i++) {\n            questions.push(\n                Question({\n                    question: _questions[i].question,\n                    options: _questions[i].options\n                })\n            );\n\n            // Question storage q = questions.push();\n            // q.question = _questions[i].question;\n            // q.options = _questions[i].options;\n        }\n    }\n\n    function submitAnswer(Answer calldata _answers) external {\n        // length validation\n        require(\n            _answers.answers.length == questions.length,\n            \"Number of answers must match number of questions\"\n        );\n        require(\n            answers.length < targetNumber,\n            \"Target number of responses reached\"\n        );\n\n        answers.push(\n            Answer({respondent: msg.sender, answers: _answers.answers})\n        );\n        payable(msg.sender).transfer(rewardAmount);\n    }\n\n    function getAnswers() external view returns (Answer[] memory) {\n        return answers;\n    }\n\n    function getQuestions() external view returns (Question[] memory) {\n        return questions;\n    }\n}\n"
      },
      "project/contracts/SurveyFactory.sol": {
        "content": "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.28;\n\nimport \"./Survey.sol\";\n\nstruct SurveySchema {\n    string title;\n    string description;\n    uint256 targetNumber;\n    Question[] questions;\n}\n\nevent SurveyCreated(address surveyAddress);\n\ncontract SurveyFactory {\n    uint256 min_pool_amount;\n    uint256 min_reward_amount;\n    Survey[] surveys;\n\n    // ex)\n    // min pool amount : 50 eth\n    // target respond number : 100\n    // reward : 50 eth / 100 == 0.5 eth\n    constructor(uint256 _min_pool_amount, uint256 _min_reward_amount) {\n        min_pool_amount = _min_pool_amount;\n        min_reward_amount = _min_reward_amount;\n    }\n\n    function createSurvey(SurveySchema calldata _survey) external payable {\n        require(\n            msg.value >= min_pool_amount,\n            \"Pool amount must be greater than minimum pool amount\"\n        );\n        require(\n            msg.value / _survey.targetNumber >= min_reward_amount,\n            \"Reward amount must be greater than minimum reward amount\"\n        );\n\n        Survey survey = new Survey{value: msg.value}(\n            _survey.title,\n            _survey.description,\n            _survey.targetNumber,\n            _survey.questions\n        );\n        surveys.push(survey);\n        emit SurveyCreated(address(survey));\n    }\n\n    function getMinPoolAmount() external view returns (uint256) {\n        return min_pool_amount;\n    }\n\n    function getMinRewardAmount() external view returns (uint256) {\n        return min_reward_amount;\n    }\n\n    function getSurveys() external view returns (Survey[] memory) {\n        return surveys;\n    }\n}\n"
      }
    }
  }
}